let TG_BOT_TOKEN="";let TG_CHAT_ID="";let HX_SINGIN_URL="https://sign.hongxing.one/sign";let HX_EMAIL="";let HX_PSD="";async function signIn(){const t=await fetch(HX_SINGIN_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:HX_EMAIL,password:HX_PSD})});let n="";if(t.ok){const s=await t.json();let e=s.data;if(e.code===200){n=`恭喜获得 ${bytesToMB(e.bytes)}MB 流量！`}else{n=e.mag}}else{n=`签到接口异常!`}if(TG_BOT_TOKEN&&TG_CHAT_ID){await sendTelegramMessage(`🎉红杏加速器签到脚本🎉\n\n邮箱：${HX_EMAIL}\n\n${n}`)}return n}async function sendTelegramMessage(e){const t=`https://api.telegram.org/bot${TG_BOT_TOKEN}/sendMessage`;const n={chat_id:TG_CHAT_ID,text:e,parse_mode:"Markdown",reply_markup:{inline_keyboard:[[{text:"问题反馈❓",url:"https://t.me/yxjsjl"}]]}};try{const s=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!s.ok){const a=await s.text();return`消息发送失败！${a}`}return"消息发送成功！"}catch(e){return`消息发送异常！${JSON.stringify(e)}`}}function bytesToMB(e){const t=e/(1024*1024);return t.toFixed(2)}async function handleRequest(e){TG_BOT_TOKEN=e.TG_BOT_TOKEN;TG_CHAT_ID=e.TG_CHAT_ID;HX_EMAIL=e.HX_EMAIL;HX_PSD=e.HX_PSD;try{if(!HX_EMAIL||!HX_PSD){return new Response("请在环境变量中配置邮箱和密码！",{status:400})}else{await signIn()}}catch(e){await sendTelegramMessage("签到时发生错误："+e.message)}}export default{async scheduled(e,t,n){await handleRequest(t)},async fetch(e,t){return new Response("看我干嘛！！！")}};
